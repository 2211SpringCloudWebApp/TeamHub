<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="TodoMapper">
	<resultMap type="Todo" id="todoResultMap">
		<id property="todoNo" column="TODO_NO"></id>
		<result property="userId" column="USER_ID" />
		<result property="todoContent" column="TODO_CONTENT" />
		<result property="todoCreateDate" column="TODO_CREATE_DATE" />
		<result property="isFinished" column="IS_FINISHED" />
	</resultMap>
	
	<insert id="insertTodo">
		INSERT INTO TODO_TBL VALUES (SEQ_TODO_TBL.NEXTVAL, #{userId}, #{todoContent}, #{todoCreateDate}, DEFAULT)
	</insert>
	
	<select id="selectTodoList" resultMap="todoResultMap">
		SELECT * FROM TODO_TBL WHERE USER_ID = #{userId} AND TO_CHAR(TODO_CREATE_DATE,'YY/MM/DD') LIKE TO_CHAR(SYSDATE,'YY/MM/DD')||'%' ORDER BY TODO_NO ASC
	</select>
	<select id="selectUpdateTodo" resultMap="todoResultMap">
		SELECT * FROM TODO_TBL WHERE TODO_NO = #{todoNo}
	</select>
	<select id="selectDayList" resultMap="todoResultMap">
		SELECT * FROM TODO_TBL WHERE USER_ID = #{userId} AND TO_CHAR(TODO_CREATE_DATE,'YY/MM/DD') LIKE #{date} ORDER BY TODO_NO ASC
	</select>
	<select id="selectEvents" resultMap="todoResultMap">
		SELECT * FROM TODO_TBL WHERE USER_ID = #{userId}
	</select>
	
	<update id="updateFinish">
		UPDATE TODO_TBL
		SET IS_FINISHED = CASE
		  WHEN IS_FINISHED = 'Y' THEN 'N'
		  WHEN IS_FINISHED = 'N' THEN 'Y'
		  ELSE IS_FINISHED
		END
		WHERE TODO_NO = #{todoNo}
	</update>
	
	<delete id="deleteTodo">
		DELETE FROM TODO_TBL WHERE TODO_NO = #{todoNo}
	</delete>
</mapper>